[26-07-25, 12:44:48 p.m.] Patricio Zamba: QUERY COBRANZA
[26-07-25, 12:44:50 p.m.] Patricio Zamba: SELECT        TOP (100) PERCENT dbo.MAEEDO.TIDO AS TIPO_DOCTO, dbo.MAEEDO.NUDO AS NRO_DOCTO, dbo.MAEEDO.ENDO AS CODIGO, dbo.MAEEN.NOKOEN AS CLIENTE, dbo.MAEEDO.SUDO AS SUC, 
                         dbo.MAEEDO.FEEMDO AS EMISION, dbo.MAEEDO.FE01VEDO AS P_VCMTO, dbo.MAEEDO.FEULVEDO AS U_VCMTO, CAST(GETDATE() - dbo.MAEEDO.FEULVEDO AS INT) AS DIAS, dbo.MAEEN.FOEN AS FONO, 
                         dbo.MAEEN.DIEN AS DIRECCION, dbo.TABCI.NOKOCI AS  REGION, dbo.TABCM.NOKOCM AS COMUNA, dbo.TABFU.NOKOFU AS VENDEDOR, dbo.TABFU.KOFU AS COD_VEN, 
                         CASE WHEN dbo.MAEEDO.TIDO = 'NCV' THEN dbo.MAEEDO.VABRDO * - 1 ELSE dbo.MAEEDO.VABRDO END AS VALOR, 
                         CASE WHEN dbo.MAEEDO.TIDO = 'NCV' THEN dbo.MAEEDO.VAABDO * - 1 ELSE dbo.MAEEDO.VAABDO END AS ABONOS, CASE WHEN dbo.MAEEDO.TIDO = 'NCV' AND (dbo.MAEEDO.VABRDO <> dbo.MAEEDO.VAABDO) AND 
                         CAST(GETDATE() - dbo.MAEEDO.FEULVEDO AS INT) BETWEEN - 7 AND - 1 THEN (dbo.MAEEDO.VABRDO - dbo.MAEEDO.VAABDO) * - 1 WHEN dbo.MAEEDO.TIDO <> 'NCV' AND (dbo.MAEEDO.VABRDO <> dbo.MAEEDO.VAABDO) 
                         AND CAST(GETDATE() - dbo.MAEEDO.FEULVEDO AS INT) BETWEEN - 7 AND - 1 THEN (dbo.MAEEDO.VABRDO - dbo.MAEEDO.VAABDO) * 1 ELSE 0 END AS POR_VENCER, CASE WHEN dbo.MAEEDO.TIDO = 'NCV' AND 
                         (dbo.MAEEDO.VABRDO <> dbo.MAEEDO.VAABDO) AND CAST(GETDATE() - dbo.MAEEDO.FEULVEDO AS INT) < - 8 THEN (dbo.MAEEDO.VABRDO - dbo.MAEEDO.VAABDO) * - 1 WHEN dbo.MAEEDO.TIDO <> 'NCV' AND 
                         (dbo.MAEEDO.VABRDO <> dbo.MAEEDO.VAABDO) AND CAST(GETDATE() - dbo.MAEEDO.FEULVEDO AS INT) < - 8 THEN (dbo.MAEEDO.VABRDO - dbo.MAEEDO.VAABDO) * 1 ELSE 0 END AS VIGENTE, 
                         CASE WHEN dbo.MAEEDO.TIDO = 'NCV' AND (dbo.MAEEDO.VABRDO <> dbo.MAEEDO.VAABDO) AND CAST(GETDATE() - dbo.MAEEDO.FEULVEDO AS INT) BETWEEN 0 AND 7 THEN (dbo.MAEEDO.VABRDO - dbo.MAEEDO.VAABDO) 
                         * - 1 WHEN dbo.MAEEDO.TIDO <> 'NCV' AND (dbo.MAEEDO.VABRDO <> dbo.MAEEDO.VAABDO) AND CAST(GETDATE() - dbo.MAEEDO.FEULVEDO AS INT) BETWEEN 0 AND 7 THEN (dbo.MAEEDO.VABRDO - dbo.MAEEDO.VAABDO) 
                         * 1 ELSE 0 END AS VENCIDO, CASE WHEN dbo.MAEEDO.TIDO = 'NCV' AND (dbo.MAEEDO.VABRDO <> dbo.MAEEDO.VAABDO) AND CAST(GETDATE() - dbo.MAEEDO.FEULVEDO AS INT) BETWEEN 8 AND 
                         30 THEN (dbo.MAEEDO.VABRDO - dbo.MAEEDO.VAABDO) * - 1 WHEN dbo.MAEEDO.TIDO <> 'NCV' AND (dbo.MAEEDO.VABRDO <> dbo.MAEEDO.VAABDO) AND CAST(GETDATE() - dbo.MAEEDO.FEULVEDO AS INT) BETWEEN 
                         8 AND 30 THEN (dbo.MAEEDO.VABRDO - dbo.MAEEDO.VAABDO) * 1 ELSE 0 END AS MOROSO, CASE WHEN dbo.MAEEDO.TIDO = 'NCV' AND (dbo.MAEEDO.VABRDO <> dbo.MAEEDO.VAABDO) AND CAST(GETDATE() 
                         - dbo.MAEEDO.FEULVEDO AS INT) > 30 THEN (dbo.MAEEDO.VABRDO - dbo.MAEEDO.VAABDO) * - 1 WHEN dbo.MAEEDO.TIDO <> 'NCV' AND (dbo.MAEEDO.VABRDO <> dbo.MAEEDO.VAABDO) AND CAST(GETDATE() 
                         - dbo.MAEEDO.FEULVEDO AS INT) > 30 THEN (dbo.MAEEDO.VABRDO - dbo.MAEEDO.VAABDO) * 1 ELSE 0 END AS BLOQUEAR, CASE WHEN dbo.MAEEDO.TIDO = 'NCV' THEN (dbo.MAEEDO.VABRDO - dbo.MAEEDO.VAABDO) 
                         * - 1 ELSE (dbo.MAEEDO.VABRDO - dbo.MAEEDO.VAABDO) END AS SALDO, CASE WHEN CAST(GETDATE() - dbo.MAEEDO.FEULVEDO AS INT) < - 8 THEN 'VIGENTE' WHEN CAST(GETDATE() - dbo.MAEEDO.FEULVEDO AS INT) 
                         BETWEEN - 7 AND - 1 THEN 'POR VENCER' WHEN CAST(GETDATE() - dbo.MAEEDO.FEULVEDO AS INT) BETWEEN 0 AND 7 THEN 'VENCIDO' WHEN CAST(GETDATE() - dbo.MAEEDO.FEULVEDO AS INT) BETWEEN 8 AND 
                         30 THEN 'MOROSO' ELSE 'BLOQUEAR' END AS ESTADO, dbo.MAEEDO.EMPRESA
FROM            dbo.TABFU RIGHT OUTER JOIN
                         dbo.MAEEN ON dbo.TABFU.KOFU = dbo.MAEEN.KOFUEN LEFT OUTER JOIN
                         dbo.TABCM ON dbo.MAEEN.CIEN = dbo.TABCM.KOCI AND dbo.MAEEN.CMEN = dbo.TABCM.KOCM RIGHT OUTER JOIN
                         dbo.MAEEDO ON dbo.MAEEN.KOEN = dbo.MAEEDO.ENDO AND dbo.MAEEN.SUEN = dbo.MAEEDO.SUENDO LEFT OUTER JOIN
                         dbo.TABCI ON dbo.MAEEN.CIEN = dbo.TABCI.KOCI
WHERE        (dbo.MAEEDO.EMPRESA = '01' OR
                         dbo.MAEEDO.EMPRESA = '02') AND (dbo.MAEEDO.TIDO = 'NCV' OR
                         dbo.MAEEDO.TIDO = 'FCV' OR
                         dbo.MAEEDO.TIDO = 'FDV') AND (dbo.MAEEDO.FEEMDO > CONVERT(DATETIME, '2017-12-31 00:00:00', 102)) AND (dbo.MAEEDO.VABRDO > dbo.MAEEDO.VAABDO)
ORDER BY DIAS
[26-07-25, 12:46:05 p.m.] Patricio Zamba: Acá por código de vendedor debes hacer el filtro, si es un usuario NO vendedor debe mostrar toda la cobranza.
[26-07-25, 12:47:51 p.m.] Patricio Zamba: Ya seleccionado el cliente, se filtra ademas por le codigo del cliente, para ver las facturas pendientes (INFORME por pantalla o pdf, excel, ahi debemos ver)


[26-07-25, 12:49:46 p.m.] Patricio Zamba: QUERY DE NOTAS DE VENTA PENDIENTES DE DESPACHO
[26-07-25, 12:49:48 p.m.] Patricio Zamba: SELECT        dbo.MAEDDO.TIDO AS TD, dbo.MAEDDO.NUDO AS NUM, dbo.MAEDDO.FEEMLI AS EMIS_FCV, dbo.MAEDDO.ENDO AS COD_CLI, dbo.MAEEN.NOKOEN AS CLIE, dbo.MAEDDO.KOPRCT, dbo.MAEDDO.CAPRCO1, 
                         dbo.MAEDDO.NOKOPR, dbo.MAEDDO.CAPRCO1 - (dbo.MAEDDO.CAPRCO1 - dbo.MAEDDO.CAPRAD1 - dbo.MAEDDO.CAPREX1) AS FACT, dbo.MAEDDO.CAPRCO1 - dbo.MAEDDO.CAPRAD1 - dbo.MAEDDO.CAPREX1 AS PEND, 
                         dbo.TABFU.NOKOFU, dbo.TABCI.NOKOCI, dbo.TABCM.NOKOCM, CAST(GETDATE() - dbo.MAEDDO.FEEMLI AS INT) AS DIAS, CASE WHEN CAST(GETDATE() - dbo.MAEDDO.FEEMLI AS INT) 
                         < 8 THEN 'Entre 1 y 7 días' WHEN CAST(GETDATE() - dbo.MAEDDO.FEEMLI AS INT) BETWEEN 8 AND 30 THEN 'Entre 8 y 30 Días' WHEN CAST(GETDATE() - dbo.MAEDDO.FEEMLI AS INT) BETWEEN 31 AND 
                         60 THEN 'Entre 31 y 60 Días' ELSE 'Mas de 60 Días' END AS Rango, dbo.MAEDDO.VANELI / dbo.MAEDDO.CAPRCO1 AS PUNIT, (dbo.MAEDDO.VANELI / dbo.MAEDDO.CAPRCO1) 
                         * (dbo.MAEDDO.CAPRCO1 - dbo.MAEDDO.CAPRAD1 - dbo.MAEDDO.CAPREX1) AS PEND_VAL, CASE WHEN MAEDDO_1.TIDO IS NULL THEN '' ELSE MAEDDO_1.TIDO END AS TD_R, CASE WHEN MAEDDO_1.NUDO IS NULL 
                         THEN '' ELSE MAEDDO_1.NUDO END AS N_FCV
FROM            dbo.MAEDDO INNER JOIN
                         dbo.MAEEN ON dbo.MAEDDO.ENDO = dbo.MAEEN.KOEN AND dbo.MAEDDO.SUENDO = dbo.MAEEN.SUEN INNER JOIN
                         dbo.TABFU ON dbo.MAEDDO.KOFULIDO = dbo.TABFU.KOFU INNER JOIN
                         dbo.TABCI ON dbo.MAEEN.PAEN = dbo.TABCI.KOPA AND dbo.MAEEN.CIEN = dbo.TABCI.KOCI INNER JOIN
                         dbo.TABCM ON dbo.MAEEN.PAEN = dbo.TABCM.KOPA AND dbo.MAEEN.CIEN = dbo.TABCM.KOCI AND dbo.MAEEN.CMEN = dbo.TABCM.KOCM LEFT OUTER JOIN
                         dbo.MAEDDO AS MAEDDO_1 ON dbo.MAEDDO.IDMAEDDO = MAEDDO_1.IDRST
WHERE        (dbo.MAEDDO.TIDO = 'NVV') AND (dbo.MAEDDO.LILG = 'SI') AND (dbo.MAEDDO.CAPRCO1 - dbo.MAEDDO.CAPRAD1 - dbo.MAEDDO.CAPREX1 <> 0) AND (dbo.MAEDDO.KOPRCT <> 'D') AND (dbo.MAEDDO.KOPRCT <> 'FLETE')
[26-07-25, 12:50:10 p.m.] Patricio Zamba: los mismos filtros, todos, vendedor, cliente.
[26-07-25, 12:52:17 p.m.] Patricio Zamba: REEMPLAZAR AL ANTERIOR
[26-07-25, 12:52:19 p.m.] Patricio Zamba: SELECT        dbo.MAEDDO.TIDO AS TD, dbo.MAEDDO.NUDO AS NUM, dbo.MAEDDO.FEEMLI AS EMIS_FCV, dbo.MAEDDO.ENDO AS COD_CLI, dbo.MAEEN.NOKOEN AS CLIE, dbo.MAEDDO.KOPRCT, dbo.MAEDDO.CAPRCO1, 
                         dbo.MAEDDO.NOKOPR, dbo.MAEDDO.CAPRCO1 - (dbo.MAEDDO.CAPRCO1 - dbo.MAEDDO.CAPRAD1 - dbo.MAEDDO.CAPREX1) AS FACT, dbo.MAEDDO.CAPRCO1 - dbo.MAEDDO.CAPRAD1 - dbo.MAEDDO.CAPREX1 AS PEND, 
                         dbo.TABFU.NOKOFU, dbo.TABFU.KOFU, dbo.TABCI.NOKOCI, dbo.TABCM.NOKOCM, CAST(GETDATE() - dbo.MAEDDO.FEEMLI AS INT) AS DIAS, CASE WHEN CAST(GETDATE() - dbo.MAEDDO.FEEMLI AS INT) 
                         < 8 THEN 'Entre 1 y 7 días' WHEN CAST(GETDATE() - dbo.MAEDDO.FEEMLI AS INT) BETWEEN 8 AND 30 THEN 'Entre 8 y 30 Días' WHEN CAST(GETDATE() - dbo.MAEDDO.FEEMLI AS INT) BETWEEN 31 AND 
                         60 THEN 'Entre 31 y 60 Días' ELSE 'Mas de 60 Días' END AS Rango, dbo.MAEDDO.VANELI / dbo.MAEDDO.CAPRCO1 AS PUNIT, (dbo.MAEDDO.VANELI / dbo.MAEDDO.CAPRCO1) 
                         * (dbo.MAEDDO.CAPRCO1 - dbo.MAEDDO.CAPRAD1 - dbo.MAEDDO.CAPREX1) AS PEND_VAL, CASE WHEN MAEDDO_1.TIDO IS NULL THEN '' ELSE MAEDDO_1.TIDO END AS TD_R, CASE WHEN MAEDDO_1.NUDO IS NULL 
                         THEN '' ELSE MAEDDO_1.NUDO END AS N_FCV
FROM            dbo.MAEDDO INNER JOIN
                         dbo.MAEEN ON dbo.MAEDDO.ENDO = dbo.MAEEN.KOEN AND dbo.MAEDDO.SUENDO = dbo.MAEEN.SUEN INNER JOIN
                         dbo.TABFU ON dbo.MAEDDO.KOFULIDO = dbo.TABFU.KOFU INNER JOIN
                         dbo.TABCI ON dbo.MAEEN.PAEN = dbo.TABCI.KOPA AND dbo.MAEEN.CIEN = dbo.TABCI.KOCI INNER JOIN
                         dbo.TABCM ON dbo.MAEEN.PAEN = dbo.TABCM.KOPA AND dbo.MAEEN.CIEN = dbo.TABCM.KOCI AND dbo.MAEEN.CMEN = dbo.TABCM.KOCM LEFT OUTER JOIN
                         dbo.MAEDDO AS MAEDDO_1 ON dbo.MAEDDO.IDMAEDDO = MAEDDO_1.IDRST
WHERE        (dbo.MAEDDO.TIDO = 'NVV') AND (dbo.MAEDDO.LILG = 'SI') AND (dbo.MAEDDO.CAPRCO1 - dbo.MAEDDO.CAPRAD1 - dbo.MAEDDO.CAPREX1 <> 0) AND (dbo.MAEDDO.KOPRCT <> 'D') AND (dbo.MAEDDO.KOPRCT <> 'FLETE')
[26-07-25, 12:52:28 p.m.] Patricio Zamba: Faltaba el codigo del vendedor
[26-07-25, 12:57:10 p.m.] Patricio Zamba: CHEQUES EN CARTERA
[26-07-25, 12:57:12 p.m.] Patricio Zamba: SELECT        TOP (100) PERCENT dbo.MAEDPCE.TIDP, dbo.MAEDPCE.NUDP, dbo.MAEDPCE.ENDP, dbo.CLIENTES.NOKOEN, dbo.MAEDPCE.FEVEDP, dbo.MAEDPCE.FEVEDP AS VCMTO, dbo.MAEDPCE.MODP, 
                         CASE WHEN dbo.MAEDPCE.TIDP = 'CHC' THEN dbo.MAEDPCE.VADP * - 1 ELSE dbo.MAEDPCE.VADP * 1 END AS VALOR, dbo.MAEDPCE.SUREDP, dbo.TABSU.NOKOSU, dbo.MAEDPCE.EMDP, dbo.MAEDPCE.SUEMDP, 
                         dbo.MAEDPCE.CUDP, dbo.MAEDPCE.FEEMDP, dbo.MAEDPCE.NUCUDP, CASE WHEN dbo.TABCTAEM.NOCTACTEEM IS NULL THEN 'CARTERA' ELSE dbo.TABCTAEM.NOCTACTEEM END AS CTA, dbo.CLIENTES.KOFUEN, 
                         dbo.TABFU.NOKOFU
FROM            dbo.TABFU INNER JOIN
                         dbo.CLIENTES ON dbo.TABFU.KOFU = dbo.CLIENTES.KOFUEN RIGHT OUTER JOIN
                         dbo.MAEDPCE ON dbo.CLIENTES.KOEN = dbo.MAEDPCE.ENDP LEFT OUTER JOIN
                         dbo.TABSU ON dbo.MAEDPCE.SUREDP = dbo.TABSU.KOSU LEFT OUTER JOIN
                         dbo.TABCTAEM ON dbo.MAEDPCE.CUDP = dbo.TABCTAEM.CTACTEEM
WHERE        (dbo.MAEDPCE.TIDP = 'CHV') AND (dbo.MAEDPCE.FEVEDP > GETDATE() - 1) AND (dbo.MAEDPCE.ESPGDP = 'P') AND (dbo.MAEDPCE.EMPRESA = '01')
ORDER BY dbo.MAEDPCE.FEVEDP